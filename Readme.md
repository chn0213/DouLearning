# 异常检测

Date:2021-09-08

Made By 纸 石头 紫阳花

_____



[TOC]

**异常成因**

数据来自于不同的类、自然变异、数据测量或者收集误差都可能导致离群点。

**异常检测方法**

1. 基于模型的技术：
    异常是那些模型不能完全拟合的对象
2. 基于邻近度：
    通常可以在对象之间定义邻近性度量，并且许多异常检测方法都基于邻近度，异常对象时那些远离大部分其他对象的对象。
3. 基于密度的技术：
    对象的密度可以直接计算，尤其是存在邻近性度量时。低密度区域中的对象相对远离近邻，可能被看作异常。或者当一个点的局部密度显著低于其大部分近邻时才将其分类为离群点。

## 统计学方法

统计学方法时基于模型的方法，即为数据创建一个模型，并且根据对象拟合模型的情况来对其进行评估。大部分用于离群点检测的统计学方法都基于一个概率分布模型。

概率分布模型通过估计用户指定的分布的参数，由数据创建。

对于单变量高斯分布，可以将通过简单的切尾来去除离群值。

对于多元正态分布的离群点，由于不同变量之间的相关性，多元正态分布并不关于中心对程，如果我们希望是哦那个一个简单的阈值来决定一个对象是否是离群点，那么我们需要一种考虑诗句分布形状的距离度量，如**Mahalanobis距离**：
$$
Mahalanobis(x, \mu)S^{-1}(x-\mu)
$$
$\mu$代表均值，S代表协方差矩阵。

点到基础分布均值的Mahalanobis距离与点的概率直接相关，Mahalanobis距离等于点的概率密度的对数加上一个常数。

### 异常检测的混合模型方法

**基于似然的离群点检测**

聚类时，混合模型方法假定数据来自混合概率分布，并且每个簇可以用这些分布之一识别。同样的，对于异常检验，数据用两个分布的混合模型建模，一个分布为普通数据，而另一个为离群点。

聚类和一场检验的目标都是估计分布的参数，以最大化数据的总似然概率。聚类时，使用EM算法估计每个概率分布的参数。而异常检验技术在初始时将所有对象放入普通对象集，而异常对象集为空，然后，用一个迭代过程将对象从普通集合转移到异常集合，**只要该转移能够提高数据的总似然**。

假设正常对啊ing和异常对象分别来自M和A两个分布模型，数据的概率总分布可记为：
$$
D(x) = (1-\lambda)M(x) + \lambda A(x)\\
\lambda介于0到1之间表示离群值的期望比例
$$
正常值分布M由数据估计，异常值分布A取均匀分布。

整个数据集的似然和对数似然分别是：

![似然](似然.png)



![捕获](%E6%8D%95%E8%8E%B7.PNG)

算法粗略的等价于将正常对象的分布下具有低概率的对象分类作为离群点。然而如果随着异常值的移除，正常对象分布显著改变，或者可以用更复杂的方法对异常的分布建模，则该方法的结果不能简单的等同于将低概率对象分类为离群点。此外即使对象分布是多峰的，该方法也能处理，但对高维数据检验的性能可能稍差一些。

### 基于邻近度的离群点检验

度量一个对象是否远离大部分的点的一种最简单的方法就是使用k-最近邻的欧氏距离。离群点得分对k的取值高度敏感，为了使方案对于k的选取更加具有鲁棒性，可以使用前k个最近邻的平均距离作为离群点得分。

邻近度离群检验方案很简单，但是对于大型数据集来说代价过高，并且不能处理具有密度区域的数据集。

### 基于密度的离群点检验

从基于密度的观点来说，离群点使在低密度区域中的对象。

一个对象的离群点得分是该对象周围密度的逆。基于密度的离群点检测与基于邻近度的离群点检测密切相关，因为密度通常用邻近度定义。一种常用的定义密度的方式是定义密度为到k何个最近邻的平均距离的倒数。

另一种密度定义是使用DBSCAN聚类算法使用的密度定义。

#### 使用相对密度进行离群检验

对象的相对密度可以用基于SNN密度的聚类算法进行定义，也可以用平均近邻密度进行定义：
$$
平均近邻密度 = \frac{density(x, k)}{\sum_{y\in N(x, k)}density(y, k)/|N(x, k)|}
$$
利用局部离群点要素技术的简化版本，首先指定近邻个数，基于对象的最近邻计算对象的密度，由此计算每个对象的离群点得分，然后计算点的近邻平均密度，并使用题目计算点的平均近邻密度，指示x与其近邻相比的密度情况，作为x的离群点得分。

### 基于聚类的技术

聚类分析强相关组，而异常检验发现不与其他对象强相关的对象，故聚类分析可以用于异常检验。

1. 丢弃聚类分析结果中远离其他簇的小簇，需要最小簇的大小和小簇与其他簇之间距离的阈值。使用此方案很难讲离群点的得分附加到对象上。
2. 一种更系统的方法是首先聚类所有对象，然后**评估对象属于簇的程度**。对于基于原型的聚类，可以用对象到其簇中心的距离来度量属于簇的程度，更一般的对于基于目标函数的聚类技术，可以使用目标函数来评估对象属于任意簇的程度。特殊情况下，若删除一个对象可以导致该目标显著改进，可将之标记为离群点。同样的，若对象不强属于任何簇，则可能为离群点。

